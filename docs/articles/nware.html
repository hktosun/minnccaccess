<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nware Data Cleaning â€¢ minnccaccess</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Nware Data Cleaning">
<meta property="og:description" content="minnccaccess">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">minnccaccess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/nware.html">Nware Data Cleaning</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="nware_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Nware Data Cleaning</h1>
            
      
      
      <div class="hidden name"><code>nware.Rmd</code></div>

    </div>

    
    
<div id="glossary" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#glossary" class="anchor"></a>Glossary</h2>
<dl>
<dt>Table</dt>
<dd>
<p>Types of raw datasets are called <em>tables</em>. There are 9 tables from the raw data: <code>general</code>, <code>population</code>, <code>provider</code>, <code>provider_address</code>, <code>provider_attributes</code>, <code>provider_name</code>, <code>provider_schedule</code>, <code>shift</code> and <code>rate</code>.</p>
</dd>
<dt>Panel</dt>
<dd>
<p>Types of clean datasets are called <em>panels</em>. There are 4 panels in the clean data: <code>characteristics</code>, <code>shift</code>, <code>shift_agegroup</code>, <code>schedule</code>.</p>
</dd>
<dt>Snapshot</dt>
<dd>
<p>The original data source is downloaded and shared with the team at a point in time. We call each round of data extraction a <code>snapshot</code>.</p>
</dd>
</dl>
</div>
<div id="step-1-going-over-raw-files" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1-going-over-raw-files" class="anchor"></a>Step 1: Going over raw files</h2>
<div id="checking-the-contents" class="section level3">
<h3 class="hasAnchor">
<a href="#checking-the-contents" class="anchor"></a>Checking the contents</h3>
<p>We started by going over all the files of type <code>.zip</code>, <code>.xls</code>, <code>.xlsx</code>, <code>.csv</code>, <code>.txt</code> and <code>.xml</code> in the folder <code>Google Drive/MinnCCAccess/Analysis/Data/Raw</code>. We identified the files that are from the Nware database. Then we classified them into two groups: supersets and subsets. A file is called <em>superset</em> if it has unique observations or columns that no other file in the folder has. A file is called <em>subset</em> if all the information in the file can be found in another superset file. If two or more files have the exact same information, only one of them is classified as superset, and all the others are labelled as subsets.</p>
<div id="determining-supersets-and-subsets" class="section level4">
<h4 class="hasAnchor">
<a href="#determining-supersets-and-subsets" class="anchor"></a>Determining supersets and subsets</h4>
<p>Rodrigo went over every file by opening the files in Excel and checking their content. He wrote a log summarizing his findings on the contents of the file and their superset/subset status.</p>
<p>Then, Hasan created a crosswalk table that contains information on the supersets of each file. Remember that a superset is a superset of itself. Then, he wrote a script that checks whether a subset is really a subset of its superset.</p>
<p>Hasan also checked whether the crosswalk table contains all the Nware files in the raw folder.</p>
</div>
<div id="determining-the-table-type" class="section level4">
<h4 class="hasAnchor">
<a href="#determining-the-table-type" class="anchor"></a>Determining the table type</h4>
<p>Rodrigo checked every file to determine what type of a table that file contains. He used this information to rename the files.</p>
</div>
<div id="determining-the-date" class="section level4">
<h4 class="hasAnchor">
<a href="#determining-the-date" class="anchor"></a>Determining the date</h4>
<p>Rodrigo used the folder names and/or the file names to determine the date the data contained in the file is captured from the database. He used this information to rename the files.</p>
</div>
</div>
<div id="renaming-the-files" class="section level3">
<h3 class="hasAnchor">
<a href="#renaming-the-files" class="anchor"></a>Renaming the files</h3>
<p>Rodrigo renamed a copy of each superset and moved them to a new folder, <code>Data Cabinet/Nware/Step 1 Data</code>. The naming convention is as follows. The first part of the name contains information on the type of data that the file contains. The types are <code>general</code>, <code>population</code>, <code>provider</code>, <code>provider_address</code>, <code>provider_attributes</code>, <code>provider_name</code>, <code>provider_schedule</code>, <code>shift</code> and <code>rate</code>. The second part of the name is the ISO 8601-formatted date of the snapshot.</p>
<p>Then, Hasan created a crosswalk table that contains the old and the new paths of the files. Then, he wrote a script that checks whether the old and the new files are actually the same. He also handchecked the filenames, by checking whether the file name actually represents the correct table type and the snapshot date.</p>
<p>Logs:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1vB6CHurv5bBsMJWRUfXdjU7t2BfsNJoq">2020-02-17, Rodrigo</a></li>
<li><a href="https://drive.google.com/file/d/1qPkDYBf0edxnQYPd5bfloitzL4ra0St9">2020-02-23, Hasan</a></li>
<li><a href="https://drive.google.com/open?id=1FLH1k_5teqoYkRiKjP0bPo01qs-pXfDl">2020-03-02, Rodrigo</a></li>
<li><a href="https://drive.google.com/open?id=1LezURu_9Km2YfIG2GZwPRYYL7UwOS8Q8">2020-03-04, Hasan</a></li>
<li><a href="https://drive.google.com/open?id=16ju4FSMv21lX19GRkuIr2ewNv0bkyYr3">2020-03-04, Rodrigo</a></li>
<li><a href="https://drive.google.com/open?id=1h8ndYDgqPWV8Opz49d3k5vcwnrYY0vO4">2020-03-18, Rodrigo</a></li>
<li><a href="https://drive.google.com/open?id=1MrAeh0jUTaaFGzd82GP_ks7fWEWPwW6B">2020-04-20, Hasan</a></li>
</ul>
</div>
</div>
<div id="step-2-merging-across-snapshots-for-each-table" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2-merging-across-snapshots-for-each-table" class="anchor"></a>Step 2: Merging across snapshots for each table</h2>
<p>In this step, we do two things. First, we had multiple periods of time for each table, since there were many snapshots. We should have merged the tables so that we have the data for each table for all dates in a single dataframe. Second, some variables changed tables over time. For example, a variable in <code>general</code> table before 2017 started to appear in <code>provider_name</code> table starting 2017. In addition, there were multiple tables with the same unit of observation. We decided to combine all the tables with the unit of observation into a single panel. We also change variable names in this step to camel case.</p>
<div id="variable-names" class="section level3">
<h3 class="hasAnchor">
<a href="#variable-names" class="anchor"></a>Variable names</h3>
<p>Please refer to <a href="https://drive.google.com/open?id=1QMqoB6pJil4zPFQ_A-MKLGEFw9VK6nwk">the variable name crosswalk</a> for the old and the new versions of the variable names. Renaming the variables before merging the files allowed us to avoid having multiple columns for the same variable (with a different name across snapshots).</p>
</div>
<div id="merging-across-time" class="section level3">
<h3 class="hasAnchor">
<a href="#merging-across-time" class="anchor"></a>Merging across time</h3>
<p>The final versions of the panels include all the snapshots from various dates.</p>
<p>An important thing to note here is that May 2012 snapshot of General table has problematic rows. We dropped these rows before appending this file.</p>
</div>
<div id="merging-tables-into-panels" class="section level3">
<h3 class="hasAnchor">
<a href="#merging-tables-into-panels" class="anchor"></a>Merging tables into panels</h3>
<p>There are four different units of observations we found in the original tables.</p>
<ol style="list-style-type: decimal">
<li>Provider - Date</li>
<li>Provider - Shift - Date</li>
<li>Provider - Shift - Age Group - Date</li>
<li>Provider - Shift - Day of Week - Date</li>
</ol>
<p><code>general</code>, <code>provider</code>, <code>provider_address</code>, <code>provider_attributes</code> and <code>provider_name</code> are in the first group. <code>shift</code> is in the second group. <code>population</code> and <code>rates</code> are in the third group. Finally, <code>provider_schedule</code> is in the fourth group. This means that we can actually have 4 tables instead of 9, by merging the tables with the same units of observations by using the correct primary/foreign keys.</p>
<p>It is important to note that <code>general</code> also contains group 2, group 3 and group 4 -type data before 2017 in a very messy way. We will talk about how we take those variables and move them to their corresponding tables in the following sections.</p>
</div>
</div>
<div id="step-3-cleaning-the-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#step-3-cleaning-the-variables" class="anchor"></a>Step 3: Cleaning the variables</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hasan Tosun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
